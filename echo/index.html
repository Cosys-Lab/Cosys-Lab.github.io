<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Pulse Echo - Cosys-AirSim</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Pulse Echo";
        var mkdocs_page_input_path = "echo.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Cosys-AirSim
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Home</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://github.com/Cosys-Lab/Cosys-AirSim/blob/main/CHANGELOG.md">Changelog</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Building AirSim</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Build on Windows</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Build on Linux</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_custenv/">Custom Unreal Environment</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Using AirSim</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../apis/">Core APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../image_apis/">Image APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../instance_segmentation/">Instance Segmentation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev_workflow/">Development Workflow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../settings/">Settings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../camera_views/">Camera Views</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../using_car/">Car Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../remote_control/">Remote Control</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../xbox_controller/">XBox Controller</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../steering_wheel_installation/">Steering Wheel</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multi_vehicle/">Multiple Vehicles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skid_steer_vehicle/">Skid Steer Vehicles</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Sensors</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../sensors/">Sensors</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../lidar/">LIDAR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../gpulidar/">GPU LIDAR</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Pulse Echo</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#enabling-echo-sensor-on-a-vehicle">Enabling echo sensor on a vehicle</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#echo-configuration">Echo configuration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#client-api">Client API</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../InfraredCamera/">Infrared Camera</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ros/">ROS: AirSim ROS Wrapper</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../playback/">Playing Logs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Design</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../design/">Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../code_structure/">Code Structure</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../modify_recording_data.md">Modifying Recording Data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../coding_guidelines/">Coding Guidelines</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../flight_controller/">Flight Controller</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../simple_flight/">Simple Flight</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">External Flight Controllers</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">MavLink and PX4</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../px4_setup/">PX4 Setup for AirSim</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_sitl/">PX4 in SITL</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://youtu.be/1oY8Qu5maQQ">AirSim with Pixhawk</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://youtu.be/HNWdYrtw3f0">PX4 Setup with AirSim</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://www.youtube.com/watch?v=d_FyjKDWQfc&feature=youtu.be">Debugging Attitude Estimation</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://github.com/Microsoft/AirSim/wiki/Intercepting-MavLink-messages">Intercepting MavLink Messages</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://github.com/Microsoft/AirSim/wiki/Rapid-Descent-on-PX4-drones">Rapid Descent on PX4 Drones</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_build/">Building PX4</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_logging/">PX4/MavLink Logging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../log_viewer/">MavLink LogViewer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">ArduPilot</a>
    <ul>
                <li class="toctree-l2"><a class="" href="https://ardupilot.org/dev/docs/building-the-code.html">ArduPilot SITL Setup</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://ardupilot.org/dev/docs/sitl-with-airsim.html">AirSim & ArduPilot</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Contributed Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../reinforcement_learning/">Reinforcement Learning</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://www.youtube.com/watch?v=y09VbdQWvQY">Using Environments from Marketplace</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/simondlevy/AirSimTensorFlow">Simple Collision Avoidance</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://aka.ms/AutonomousDrivingCookbook">Autonomous Driving on Azure</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/Microsoft/AirSim/wiki/hexacopter">Building Hexacopter</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo">Moving on Path Demo</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://youtu.be/Bp86WiLUC80">Importing a custom multirotor mesh</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://youtu.be/ZonkdMcwXH4">AirSim with MAVROS and PX4</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Misc</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_drone/">AirSim on Real Drones</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cmake_linux/">Installing cmake on Linux</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hard_drive/">Tips for Busy HDD</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pfm/">pfm format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_proj/">Setting up Unreal Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_blocks/">Blocks Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../who_is_using/">Who is Using AirSim</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../working_with_plugin_contents/">Working with UE Plugin Contents</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/Microsoft/AirSim/wiki/technion">Formula Student Technion Self-drive</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Support</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../faq/">FAQ</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Cosys-AirSim</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Using AirSim &raquo;</li>
          <li>Sensors &raquo;</li>
      <li>Pulse Echo</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/Cosys-Lab/Cosys-AirSim/edit/main/docs/echo.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="how-to-use-echo-sensor-modalities-in-airsim">How to Use Echo sensor modalities in AirSim</h1>
<p>AirSim supports Echo sensors for multirotors and cars.  Echo sensors can be configured to behave like sonar, radar or other echo-based sensor types.</p>
<p>The enablement of an echo sensor and the other settings can be configured via AirSimSettings json.
Please see <a href="../sensors/">general sensors</a> for information on configuration of general/shared sensor settings.</p>
<h2 id="enabling-echo-sensor-on-a-vehicle">Enabling echo sensor on a vehicle</h2>
<ul>
<li>By default, echo sensors are not enabled. To enable one, set the SensorType and Enabled attributes in settings json.</li>
</ul>
<pre><code>        &quot;echo1&quot;: { 
             &quot;SensorType&quot;: 7,
             &quot;Enabled&quot; : true,
</code></pre>
<ul>
<li>Multiple echo sensors can be enabled on a vehicle.</li>
</ul>
<h2 id="echo-configuration">Echo configuration</h2>
<p>The following parameters can be configured right now via settings json.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NumberOfTraces</td>
<td>Amount of traces (rays) being cast</td>
</tr>
<tr>
<td>SensorOpeningAngle</td>
<td>The angle for receiving signals on the sensor</td>
</tr>
<tr>
<td>ReflectionOpeningAngle</td>
<td>Opening angle of reflections</td>
</tr>
<tr>
<td>AttenuationPerDistance</td>
<td>Attenuation of signal wrt distance traveled (dB/m)</td>
</tr>
<tr>
<td>AttenuationPerReflection</td>
<td>Attenuation of signal wrt reflections (dB)</td>
</tr>
<tr>
<td>AttenuationLimit</td>
<td>Attenuation at which the signal is considered dissipated (dB)</td>
</tr>
<tr>
<td>DistanceLimit</td>
<td>Maximum distance a reflection can travel</td>
</tr>
<tr>
<td>ReflectionLimit</td>
<td>Maximum amount of reflections that can happen</td>
</tr>
<tr>
<td>ReflectionDistanceLimit</td>
<td>Maximum distance between two reflections</td>
</tr>
<tr>
<td>MeasurementFrequency</td>
<td>The frequency of the sensor (measurements/s)</td>
</tr>
<tr>
<td>SensorDiameter</td>
<td>The diameter of the sensor plane used to capture the reflecting traces (meter)</td>
</tr>
<tr>
<td>PauseAfterMeasurement</td>
<td>Pause the simulation after each measurement. Useful for API interaction to be synced</td>
</tr>
<tr>
<td>X Y Z</td>
<td>Position of the echo relative to the vehicle (in NED, in meters)</td>
</tr>
<tr>
<td>Roll Pitch Yaw</td>
<td>Orientation of the echo relative to the vehicle  (in degrees, yaw-pitch-roll order to front vector +X)</td>
</tr>
<tr>
<td>DrawReflectedPoints</td>
<td>Draw debug points in world where reflected points are captured by the sensor</td>
</tr>
<tr>
<td>DrawReflectedLines</td>
<td>Draw debug lines in world from reflected points to the sensor</td>
</tr>
<tr>
<td>DrawReflectedPaths</td>
<td>Draw the full paths of the reflected points</td>
</tr>
<tr>
<td>DrawInitialPoints</td>
<td>Draw the points of the initial half sphere where the traces (rays) are cast</td>
</tr>
<tr>
<td>DrawExternalPoints</td>
<td>Draw a pointcloud coming through the API from an external source</td>
</tr>
<tr>
<td>DrawBounceLines</td>
<td>Draw lines of all bouncing reflections of the traces with their color depending on attenuation</td>
</tr>
<tr>
<td>DrawSensor</td>
<td>Draw the physical sensor in the world on the vehicle with a 3D axes shown where the sensor is</td>
</tr>
<tr>
<td>IgnoreMarked</td>
<td>Remove objects with the Unreal Tag <em>MarkedIgnore</em> from the sensor data</td>
</tr>
<tr>
<td>External</td>
<td>Uncouple the sensor from the vehicle. If enabled, the position and orientation will be relative to Unreal world coordinates</td>
</tr>
<tr>
<td>ExternalLocal</td>
<td>When in external mode, if this is enabled the retrieved pose of the sensor will be in Local NED coordinates(from starting position from vehicle) and not converted Unreal NED coordinates which is default</td>
</tr>
<tr>
<td>e.g.,</td>
<td></td>
</tr>
</tbody>
</table>
<pre><code>{
    &quot;SeeDocsAt&quot;: &quot;settings_json.md&quot;,
    &quot;SettingsVersion&quot;: 1.2,
    &quot;SimMode&quot;: &quot;SkidVehicle&quot;,
    &quot;Vehicles&quot;: {
        &quot;CPHusky&quot;: {
            &quot;VehicleType&quot;: &quot;CPHusky&quot;,
            &quot;AutoCreate&quot;: true,
            &quot;Sensors&quot;: {
                &quot;SonarSensor1&quot;: {
                      &quot;SensorType&quot;: 7,
                      &quot;Enabled&quot;: true,
                      &quot;X&quot;: 0,
                      &quot;Y&quot;: 0,
                      &quot;Z&quot;: -0.55,
                      &quot;Roll&quot;: 0,
                      &quot;Pitch&quot;: 0,
                      &quot;Yaw&quot;: 0,
                      &quot;MeasurementFrequency&quot;: 5,
                      &quot;NumberOfTraces&quot;: 30000,
                      &quot;DistanceLimit&quot;: 5,
                      &quot;SensorDiameter&quot;: 0.1,
                      &quot;SensorOpeningAngle&quot;: 180,
                      &quot;Wavelength&quot;: 0.01,
                      &quot;AttenuationLimit&quot;: -100,
                      &quot;ReflectionDepth&quot;: 3,
                      &quot;ReflectionDistanceLimit&quot;: 1,
                      &quot;ReflectionOpeningAngle&quot;: 10,
                      &quot;DrawInitialPoints&quot;: false,
                      &quot;DrawBounceLines&quot;: false,
                      &quot;DrawReflectedPoints&quot;: true,
                      &quot;DrawReflectedLines&quot;: false,
                      &quot;DrawReflectedPaths&quot;: false,
                      &quot;DrawExternalPoints&quot;: false,
                      &quot;DrawSensor&quot;: false
                }   
            }
        }
    }
}
</code></pre>
<h2 id="client-api">Client API</h2>
<p>Use <code>getEchoData(sensor name, vehicle name)</code> API to retrieve the echo sensor data. 
* The API returns a Point-Cloud as a flat array of floats, the final attenuation, total distance along with the timestamp of the capture and sensor pose.
* Point-Cloud: 
  * The floats represent [x, y, z, attenuation, total_distance] for each point hit within the range in the last scan. 
* Echo Pose:
    * Default: Echo sensor pose in the vehicle frame. 
    * External: If set to <code>External</code>(see table) the coordinates will be in either Unreal NED when <code>ExternalLocal</code> is <code>false</code> or Local NED (from starting position from vehicle) when <code>ExternalLocal</code> is <code>true</code>.</p>
<p>Use <code>setEchoData(sensor name, vehicle name, echo data)</code> API to render an external pointcloud back to the simulation. It expects it to be [x,y,z] as a flat array of floats.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../gpulidar/" class="btn btn-neutral float-left" title="GPU LIDAR"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../InfraredCamera/" class="btn btn-neutral float-right" title="Infrared Camera">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/Cosys-Lab/Cosys-AirSim" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../gpulidar/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../InfraredCamera/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
